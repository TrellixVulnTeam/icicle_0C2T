var fylkesdata = {
  "type":"FeatureCollection", "features": [

  {"type":"Feature","geometry":{"type":"Polygon","coordinates":[[[10.685279,59.488346],[10.964416,59.653008],[11.377858,59.685532],[11.539554,59.614662],[11.776625,59.77911],[11.927287,59.78849],[11.941165,59.694382],[11.693858,59.606499],[11.836008,59.244617],[11.653469,58.907196],[11.464693,58.890198],[11.34691,59.113125],[10.729722,59.232639],[10.611943,59.442917],[10.685279,59.488346]]]},"properties":{"cartodb_id":1,"id_1":1,"id_0":169,"varname_1":"Oestfold fylke","nl_name_1":null,"engtype_1":"County","type_1":"Fylke","name_1":"Ãstfold","name_0":"Norway","iso":"NOR"}},
  {"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[10.642497,59.911304],[10.500277,59.783192],[10.343001,59.96669],[10.501617,60.01453],[10.642497,59.911304]]],[[[10.714067,60.514671],[11.099051,60.522785],[11.162199,60.594913],[11.567092,60.177555],[11.811315,60.039104],[11.842123,59.842007],[11.927287,59.78849],[11.776625,59.77911],[11.539554,59.614662],[11.377858,59.685532],[10.964416,59.653008],[10.685279,59.488346],[10.581389,59.761806],[10.771389,59.832085],[10.931127,59.972343],[10.697778,60.12373],[10.917985,60.347477],[10.714067,60.514671]]]]},"properties":{"cartodb_id":2,"id_1":2,"id_0":169,"varname_1":"Akershus fylke","nl_name_1":null,"engtype_1":"County","type_1":"Fylke","name_1":"Akershus","name_0":"Norway","iso":"NOR"}},
  {"type":"Feature","geometry":{"type":"Polygon","coordinates":[[[9.362674,58.763748],[9.041388,58.617085],[8.515277,58.26125],[8.183057,58.141529],[8.19824,58.250393],[7.723,58.464615],[7.554216,58.689903],[7.571533,58.860481],[7.163638,58.838104],[7.110436,59.001789],[7.17198,59.167931],[6.932773,59.184834],[6.834488,59.343967],[7.006305,59.480331],[6.980555,59.592033],[7.192196,59.677143],[7.479795,59.636745],[7.605882,59.493683],[7.607828,59.34325],[7.731574,59.177177],[7.996241,58.960613],[8.213946,58.971832],[8.744052,58.842236],[8.865018,58.984833],[9.362674,58.763748]]]},"properties":{"cartodb_id":3,"id_1":3,"id_0":169,"varname_1":"Aust-Agder fylke|Austur-Agðir|Nedenes","nl_name_1":null,"engtype_1":"County","type_1":"Fylke","name_1":"Aust-Agder","name_0":"Norway","iso":"NOR"}},
  {"type":"Feature","geometry":{"type":"Polygon","coordinates":[[[10.595679,60.130093],[10.501617,60.01453],[10.343001,59.96669],[10.500277,59.783192],[10.314885,59.69236],[9.976753,59.648727],[10.04881,59.468193],[9.771088,59.41021],[9.466491,59.553844],[9.354913,59.790165],[8.966204,60.085396],[8.742929,60.175701],[8.202733,60.196747],[7.831183,60.108162],[7.494721,60.09935],[7.677759,60.294666],[7.70798,60.530247],[7.466191,60.672054],[7.701792,60.739635],[7.86888,60.914597],[8.057561,60.913258],[8.250697,61.076149],[8.619805,60.94379],[9.291706,60.762421],[9.418389,60.549763],[9.826799,60.458935],[9.82499,60.581402],[10.001151,60.640106],[10.148196,60.523956],[10.305771,60.276936],[10.595679,60.130093]]]},"properties":{"cartodb_id":4,"id_1":4,"id_0":169,"varname_1":"Buskerud fylke","nl_name_1":null,"engtype_1":"County","type_1":"Fylke","name_1":"Buskerud","name_0":"Norway","iso":"NOR"}},
  {"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[23.486979,70.625519],[23.639063,70.445313],[23.195833,70.275002],[22.885937,70.36615],[22.881771,70.457817],[23.481771,70.572395],[23.486979,70.625519]]],[[[23.725521,70.746353],[24.134895,70.601562],[23.733854,70.52552],[23.725521,70.746353]]],[[[23.325521,70.858849],[23.447916,70.78125],[23.06823,70.57135],[22.23073,70.4776],[22.118229,70.649483],[22.830729,70.65052],[23.325521,70.858849]]],[[[21.99329,69.071091],[22.474253,69.110207],[22.525221,69.226738],[22.273705,69.48259],[22.673685,69.513268],[22.451611,69.926857],[22.23295,69.956665],[22.083227,70.1614],[21.840904,70.105278],[21.198803,70.223213],[21.485937,70.309898],[21.927605,70.322395],[22.964062,70.195312],[22.976563,70.044266],[23.365105,70.114067],[23.202604,70.202599],[23.870832,70.497917],[24.039583,70.512497],[24.314583,70.689583],[24.242188,70.8349],[24.567188,70.856766],[24.620312,70.993233],[25.189583,70.900002],[25.88698,70.895317],[25.74375,70.785416],[25.220833,70.560417],[25.166145,70.2901],[24.904688,70.151566],[25.154167,70.064583],[25.486979,70.269272],[25.396355,70.325516],[25.986979,70.610939],[26.129688,70.74115],[26.5625,70.95208],[26.689062,70.748436],[26.582813,70.482811],[26.96302,70.583855],[27.289583,70.831253],[27.210417,71.018753],[28.245832,71.087502],[28.549479,70.976562],[28.439062,70.867188],[27.939583,70.666664],[28.426563,70.502602],[28.515104,70.725517],[28.822916,70.872917],[29.249479,70.844269],[29.378647,70.690102],[29.723438,70.736984],[30.203646,70.673439],[30.433853,70.551567],[31.041145,70.388016],[31.045834,70.28125],[30.513021,70.239067],[30.301563,70.123436],[29.825001,70.0625],[29.029167,70.125],[28.941668,70.064583],[29.647396,69.972397],[29.702084,69.914581],[30.842518,69.791664],[30.945555,69.58622],[30.526632,69.542526],[30.365776,69.617111],[29.986135,69.413345],[29.314947,69.30278],[29.258862,69.119812],[28.805199,69.10611],[28.842869,69.23159],[29.32601,69.466721],[29.14175,69.671829],[28.404531,69.816162],[27.980879,70.012123],[27.62171,70.077103],[27.104359,69.916008],[26.454679,69.935173],[26.37578,69.847282],[25.896759,69.673012],[25.947676,69.576324],[25.70907,69.258171],[25.769058,69.002953],[25.143173,68.791557],[25.080025,68.621689],[24.249142,68.724907],[23.970842,68.83065],[23.67716,68.706123],[23.19829,68.638748],[22.797892,68.686119],[22.354448,68.809769],[21.99329,69.071091]]],[[[25.677605,71.15052],[25.989584,71.008331],[25.549999,70.931252],[25.254168,71.035416],[25.677605,71.15052]]]]},"properties":{"cartodb_id":5,"id_1":5,"id_0":169,"varname_1":"Finnmark fylke|Finmarken|Finnmárkku|Finnmörk","nl_name_1":null,"engtype_1":"County","type_1":"Fylke","name_1":"Finnmark","name_0":"Norway","iso":"NOR"}},
  {"type":"Feature","geometry":{"type":"Polygon","coordinates":[[[12.25414,62.330662],[12.302385,62.256443],[12.141136,61.718437],[12.396324,61.574497],[12.568355,61.57032],[12.852286,61.368546],[12.688181,61.061741],[12.231456,61.018288],[12.393183,60.733704],[12.59488,60.541664],[12.498363,60.323933],[12.541138,60.17725],[12.462191,60.046268],[12.182252,59.889839],[11.842123,59.842007],[11.811315,60.039104],[11.567092,60.177555],[11.162199,60.594913],[10.705463,60.799641],[10.484002,61.010899],[10.736183,61.236916],[10.625251,61.700893],[10.402921,61.676533],[10.054341,61.74715],[10.125503,61.883904],[9.838906,61.904068],[9.917418,62.046047],[9.592506,62.172127],[9.752524,62.274822],[10.083881,62.425766],[10.002331,62.551712],[10.103199,62.663242],[10.903328,62.698555],[11.674014,62.383556],[12.25414,62.330662]]]},"properties":{"cartodb_id":6,"id_1":6,"id_0":169,"varname_1":"Hedmark fylke|Hedemarken|Heiðmörk","nl_name_1":null,"engtype_1":"County","type_1":"Fylke","name_1":"Hedmark","name_0":"Norway","iso":"NOR"}},
  {"type":"Feature","geometry":{"type":"Polygon","coordinates":[[[6.160417,60.212502],[6.197917,60.322918],[5.902083,60.15625],[5.893229,60.01302],[5.694722,59.989307],[5.6225,59.874863],[5.359185,59.997219],[5.750521,60.07552],[5.747917,60.179165],[5.4,60.154167],[5.18125,60.377083],[5.29375,60.541668],[5.08125,60.612499],[4.902083,60.741665],[4.972917,60.731251],[5.120833,60.674999],[5.152083,60.679165],[5.024987,60.760456],[5.272917,60.820835],[5.202083,60.833332],[5.152541,60.841084],[5.301445,60.927723],[5.629942,60.977188],[6.148135,60.921673],[6.808989,60.924252],[7.093486,60.714172],[7.466191,60.672054],[7.70798,60.530247],[7.677759,60.294666],[7.494721,60.09935],[7.190856,59.937481],[7.096686,59.781937],[6.772716,59.703583],[6.672056,59.839703],[6.283641,59.762619],[6.190896,59.592388],[5.904651,59.602688],[5.54821,59.543472],[5.594166,59.68486],[5.881944,59.768749],[5.791945,59.927639],[5.987486,59.95752],[6.197917,60.112499],[6.160417,60.212502]]]},"properties":{"cartodb_id":7,"id_1":7,"id_0":169,"varname_1":"Hordaland fylke|Hörðaland|Søndre Bergenhus","nl_name_1":null,"engtype_1":"County","type_1":"Fylke","name_1":"Hordaland","name_0":"Norway","iso":"NOR"}},
  {"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[5.889583,62.052082],[6.013021,62.272396],[6.339583,62.360416],[6.577083,62.150002],[6.522917,62.229168],[6.408854,62.384899],[6.716667,62.491665],[6.241667,62.552082],[6.7875,62.654167],[7.08125,62.652084],[7.525521,62.517185],[7.714583,62.564583],[7.760417,62.566666],[7.400521,62.62656],[7.447917,62.756248],[6.985416,62.724998],[7.041667,62.970833],[7.233333,63.006248],[7.316667,63.008335],[7.49375,63.070835],[7.664583,63.110416],[7.810417,62.943748],[8.118229,62.922398],[8.133854,62.82552],[8.445833,62.752083],[8.156771,62.85677],[8.139063,62.945312],[7.885937,63.024479],[8.156771,63.124481],[8.764063,63.183857],[8.850689,63.116699],[9.359086,63.214348],[9.498941,63.02449],[9.416664,62.809219],[8.90227,62.692627],[9.234372,62.545319],[9.060836,62.372684],[8.615995,62.378315],[8.169434,62.3368],[7.986511,62.179768],[7.729575,62.184772],[7.352152,62.009308],[6.783068,61.969845],[6.680222,62.069874],[6.336399,61.963032],[6.001268,61.989079],[5.56497,61.957886],[5.494246,62.022915],[5.498437,62.024479],[5.502476,62.026436],[5.410937,62.125519],[5.89375,62.195835],[5.889583,62.052082]]],[[[8.839809,63.202084],[8.6125,63.189583],[8.53125,63.383335],[8.741421,63.422836],[8.745833,63.422916],[8.748527,63.423119],[8.839809,63.202084]]],[[[7.996354,63.473434],[8.2125,63.375],[8.002084,63.304165],[7.778646,63.366146],[7.996354,63.473434]]]]},"properties":{"cartodb_id":8,"id_1":8,"id_0":169,"varname_1":"Moere og Romsdal fylk|Møre|Romsdal","nl_name_1":null,"engtype_1":"County","type_1":"Fylke","name_1":"Møre og Romsdal","name_0":"Norway","iso":"NOR"}},
  {"type":"Feature","geometry":{"type":"Polygon","coordinates":[[[10.904166,63.46875],[10.841666,63.637501],[10.952084,63.700001],[11.432813,63.775524],[11.05677,63.968231],[10.941667,63.739582],[10.169188,63.526482],[10.129988,63.587006],[10.444855,63.744095],[10.594027,63.912552],[10.783017,63.99704],[10.880029,64.207161],[10.624479,64.38195],[10.622236,64.383331],[10.612733,64.383331],[10.56916,64.398552],[10.502839,64.425003],[10.80625,64.414581],[10.885417,64.493752],[11.377084,64.431252],[11.40625,64.70208],[11.625,64.810417],[11.391666,64.75],[11.042188,64.857811],[10.7125,64.82917],[10.658334,64.877083],[10.74375,64.90625],[11.1625,64.956253],[11.35,64.893753],[11.9246,65.142555],[12.183478,64.973396],[12.618667,64.945183],[12.899614,64.972008],[13.087855,65.111671],[13.369235,65.101425],[14.164573,65.138031],[14.310424,65.107368],[13.660572,64.594353],[14.084557,64.480606],[14.157517,64.235298],[13.975808,64.020538],[13.290632,64.086067],[12.925197,64.060135],[12.697851,63.981346],[12.15596,63.59626],[12.207691,63.481403],[11.980528,63.279045],[12.057063,63.18372],[11.637144,63.17815],[11.452974,63.325905],[10.946242,63.331444],[10.851871,63.437431],[10.904166,63.46875]]]},"properties":{"cartodb_id":9,"id_1":9,"id_0":169,"varname_1":"Nord-Troendelag fylke|Nordre Trondhjem|Norður-Þrændalög","nl_name_1":null,"engtype_1":"County","type_1":"Fylke","name_1":"Nord-Trøndelag","name_0":"Norway","iso":"NOR"}},
  {"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[13.969271,68.346352],[14.060416,68.193748],[13.460938,68.079689],[13.516666,68.245834],[13.969271,68.346352]]],[[[12.914583,65.293747],[12.49375,65.133331],[12.404166,65.260414],[12.109896,65.32135],[12.245302,65.516151],[12.535417,65.449997],[12.355729,65.631767],[12.611979,65.783852],[12.646354,65.905731],[12.933333,66.020836],[12.669271,66.06823],[13.035417,66.20417],[13.155729,66.414063],[12.975521,66.526566],[13.277083,66.629166],[13.741667,66.947914],[14.102083,67.058334],[14.383333,67.21875],[15.1,67.23542],[15.033334,67.320831],[14.63125,67.383331],[14.652604,67.478645],[15.24375,67.616669],[14.858334,67.693748],[14.754167,67.729164],[15.010417,67.854164],[15.68125,67.960419],[15.282813,68.059898],[15.4125,68.14167],[15.822917,68.114586],[16.366667,68.035416],[16.460938,68.225517],[16.079687,68.418228],[16.435417,68.541664],[16.575487,68.544304],[17.291019,68.561279],[18.010155,68.611427],[18.126932,68.536102],[18.154524,68.194],[17.885277,67.970184],[17.306782,68.115311],[16.73361,67.911591],[16.431082,67.544899],[16.097973,67.42482],[16.398287,67.215157],[16.388906,67.043694],[16.030619,66.909286],[15.606582,66.587402],[15.376294,66.486328],[15.480573,66.281853],[15.036372,66.151505],[14.516809,66.134575],[14.618682,65.808624],[14.494909,65.51107],[14.512543,65.322197],[14.310424,65.107368],[14.164573,65.138031],[13.369235,65.101425],[13.087855,65.111671],[12.899614,64.972008],[12.618667,64.945183],[12.183478,64.973396],[11.9246,65.142555],[12.222917,65.214584],[12.34375,65.083336],[12.598437,65.141151],[12.914583,65.293747]]],[[[15.847216,68.966431],[15.732502,68.494263],[16.152693,68.616776],[16.465567,68.556252],[16.106771,68.526566],[15.959896,68.394272],[15.65625,68.308334],[15.258333,68.368752],[14.664583,68.237503],[14.235416,68.183334],[14.331771,68.341148],[14.600521,68.434898],[15.254167,68.466667],[15.510417,68.64167],[15.433854,68.7099],[15.6375,68.95208],[15.847216,68.966431]]],[[[15.158854,69.019272],[15.404166,68.84375],[15.420313,68.688019],[15.033334,68.57708],[14.386979,68.688019],[14.450521,68.767189],[14.860416,68.793747],[15.158854,69.019272]]]]},"properties":{"cartodb_id":10,"id_1":10,"id_0":169,"varname_1":"Nordland fylke","nl_name_1":null,"engtype_1":"County","type_1":"Fylke","name_1":"Nordland","name_0":"Norway","iso":"NOR"}},
  {"type":"Feature","geometry":{"type":"Polygon","coordinates":[[[10.714067,60.514671],[10.917985,60.347477],[10.697778,60.12373],[10.595679,60.130093],[10.305771,60.276936],[10.148196,60.523956],[10.001151,60.640106],[9.82499,60.581402],[9.826799,60.458935],[9.418389,60.549763],[9.291706,60.762421],[8.619805,60.94379],[8.250697,61.076149],[8.030439,61.207306],[8.16393,61.305664],[8.23524,61.544369],[7.941311,61.559834],[7.904891,61.72546],[7.49714,61.730072],[7.352152,62.009308],[7.729575,62.184772],[7.986511,62.179768],[8.169434,62.3368],[8.615995,62.378315],[9.060836,62.372684],[9.752524,62.274822],[9.592506,62.172127],[9.917418,62.046047],[9.838906,61.904068],[10.125503,61.883904],[10.054341,61.74715],[10.402921,61.676533],[10.625251,61.700893],[10.736183,61.236916],[10.484002,61.010899],[10.705463,60.799641],[11.162199,60.594913],[11.099051,60.522785],[10.714067,60.514671]]]},"properties":{"cartodb_id":11,"id_1":11,"id_0":169,"varname_1":"Oppland fylke|Kristian|Opland|Upplönd","nl_name_1":null,"engtype_1":"County","type_1":"Fylke","name_1":"Oppland","name_0":"Norway","iso":"NOR"}},
  {"type":"Feature","geometry":{"type":"Polygon","coordinates":[[[10.771389,59.832085],[10.645834,59.911541],[10.642497,59.911304],[10.501617,60.01453],[10.595679,60.130093],[10.697778,60.12373],[10.931127,59.972343],[10.771389,59.832085]]]},"properties":{"cartodb_id":12,"id_1":12,"id_0":169,"varname_1":"Oslo fylke|Kristiania","nl_name_1":null,"engtype_1":"County","type_1":"Fylke","name_1":"Oslo","name_0":"Norway","iso":"NOR"}},
  {"type":"Feature","geometry":{"type":"Polygon","coordinates":[[[5.624723,59.384304],[5.348612,59.271526],[5.239722,59.507416],[5.45861,59.498035],[5.54821,59.543472],[5.904651,59.602688],[6.190896,59.592388],[6.283641,59.762619],[6.672056,59.839703],[6.772716,59.703583],[7.096686,59.781937],[7.192196,59.677143],[6.980555,59.592033],[7.006305,59.480331],[6.834488,59.343967],[6.932773,59.184834],[6.906821,59.11359],[6.603575,58.976826],[6.548313,58.82452],[6.625694,58.69545],[6.610364,58.373512],[6.396946,58.270416],[6.050834,58.374306],[5.661945,58.552917],[5.493611,58.755138],[5.578611,58.897915],[6.190279,59.257637],[6.098612,59.332638],[5.745834,59.331528],[5.624723,59.384304]]]},"properties":{"cartodb_id":13,"id_1":13,"id_0":169,"varname_1":"Rogaland fylke|Stavanger","nl_name_1":null,"engtype_1":"County","type_1":"Fylke","name_1":"Rogaland","name_0":"Norway","iso":"NOR"}},
  {"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[10.851871,63.437431],[10.946242,63.331444],[11.452974,63.325905],[11.637144,63.17815],[12.057063,63.18372],[12.216042,63.002392],[12.073231,62.904118],[12.136997,62.740269],[12.059846,62.62291],[12.25414,62.330662],[11.674014,62.383556],[10.903328,62.698555],[10.103199,62.663242],[10.002331,62.551712],[10.083881,62.425766],[9.752524,62.274822],[9.060836,62.372684],[9.234372,62.545319],[8.90227,62.692627],[9.416664,62.809219],[9.498941,63.02449],[9.359086,63.214348],[8.850689,63.116699],[8.764063,63.183857],[8.839809,63.202084],[8.748527,63.423119],[8.982813,63.443226],[9.52552,63.599476],[9.739583,63.608334],[9.980729,63.441143],[10.851871,63.437431]]],[[[8.808854,63.660938],[8.995833,63.654167],[9.08125,63.504166],[8.385417,63.427082],[8.264584,63.510418],[8.808854,63.660938]]],[[[9.697917,63.856251],[9.956771,63.947399],[10.039583,64.060417],[10.452084,64.352081],[10.624479,64.38195],[10.880029,64.207161],[10.783017,63.99704],[10.594027,63.912552],[10.444855,63.744095],[10.129988,63.587006],[10.169188,63.526482],[9.99375,63.485416],[9.558854,63.770309],[9.697917,63.856251]]]]},"properties":{"cartodb_id":14,"id_1":14,"id_0":169,"varname_1":"Soer-Troendelag fylke|Søndre Trondhjem|Suður-Þrændalög","nl_name_1":null,"engtype_1":"County","type_1":"Fylke","name_1":"Sør-Trøndelag","name_0":"Norway","iso":"NOR"}},
  {"type":"Feature","geometry":{"type":"Polygon","coordinates":[[[5.05625,60.958332],[5.6625,61.102085],[5.997396,61.12656],[6.448437,61.078644],[6.71875,61.150002],[7.009896,61.06406],[7.033333,60.977085],[7.189583,60.924999],[7.039583,61.041668],[7.047916,61.060417],[7.18125,61.118752],[7.202083,61.131248],[7.345833,61.120834],[7.408333,61.364582],[7.252604,61.296356],[7.33125,61.158333],[6.944271,61.116146],[6.597917,61.206249],[6.358333,61.112499],[6.183333,61.158333],[5.723437,61.166149],[5.425,61.072918],[5.108333,61.166668],[4.95625,61.275002],[5.310417,61.356251],[5.295833,61.547916],[4.997917,61.629166],[4.973437,61.722393],[5.427083,61.916668],[5.879167,61.856251],[5.45,61.9375],[5.15,61.910416],[5.494246,62.022915],[5.56497,61.957886],[6.001268,61.989079],[6.336399,61.963032],[6.680222,62.069874],[6.783068,61.969845],[7.352152,62.009308],[7.49714,61.730072],[7.904891,61.72546],[7.941311,61.559834],[8.23524,61.544369],[8.16393,61.305664],[8.030439,61.207306],[8.250697,61.076149],[8.057561,60.913258],[7.86888,60.914597],[7.701792,60.739635],[7.466191,60.672054],[7.093486,60.714172],[6.808989,60.924252],[6.148135,60.921673],[5.629942,60.977188],[5.301445,60.927723],[5.152541,60.841084],[5.05625,60.958332]]]},"properties":{"cartodb_id":15,"id_1":15,"id_0":169,"varname_1":"Sogn og Fjordane fyl|Nordre Bergenhus|Sogn og Firða-Fylki","nl_name_1":null,"engtype_1":"County","type_1":"Fylke","name_1":"Sogn og Fjordane","name_0":"Norway","iso":"NOR"}},
  {"type":"Feature","geometry":{"type":"Polygon","coordinates":[[[9.771088,59.41021],[9.879636,59.169075],[9.835583,59.038193],[9.394723,58.852085],[9.362674,58.763748],[8.865018,58.984833],[8.744052,58.842236],[8.213946,58.971832],[7.996241,58.960613],[7.731574,59.177177],[7.607828,59.34325],[7.605882,59.493683],[7.479795,59.636745],[7.192196,59.677143],[7.096686,59.781937],[7.190856,59.937481],[7.494721,60.09935],[7.831183,60.108162],[8.202733,60.196747],[8.742929,60.175701],[8.966204,60.085396],[9.354913,59.790165],[9.466491,59.553844],[9.771088,59.41021]]]},"properties":{"cartodb_id":16,"id_1":16,"id_0":169,"varname_1":"Telemark fylke|Bratsberg|Þelamörk","nl_name_1":null,"engtype_1":"County","type_1":"Fylke","name_1":"Telemark","name_0":"Norway","iso":"NOR"}},
  {"type":"Feature","geometry":{"type":"MultiPolygon","coordinates":[[[[16.465567,68.556252],[16.152693,68.616776],[15.732502,68.494263],[15.847216,68.966431],[16.0875,68.824997],[16.487499,68.856247],[16.59948,68.718231],[16.465567,68.556252]]],[[[17.498438,69.596352],[17.862499,69.581253],[18.06823,69.488022],[17.867188,69.232811],[17.185938,69.083855],[16.981251,69.14167],[16.920313,69.299484],[17.264063,69.414062],[17.498438,69.596352]]],[[[18.720833,69.870834],[19.00573,69.733849],[18.727083,69.556252],[18.197916,69.518753],[18.010937,69.560936],[18.720833,69.870834]]],[[[19.202604,70.08802],[19.541145,70.0401],[19.347397,69.823433],[19.106251,69.785416],[18.719271,69.953651],[19.202604,70.08802]]],[[[18.933332,69.322914],[18.652082,69.362503],[18.51198,69.506767],[18.856251,69.552086],[19.277082,69.777084],[19.993229,69.817184],[20.46875,69.756248],[21.120832,69.870834],[21.237499,70.008331],[21.906771,69.873436],[21.854166,70.010414],[21.181276,70.222916],[21.194874,70.223236],[21.198803,70.223213],[21.840904,70.105278],[22.083227,70.1614],[22.23295,69.956665],[22.451611,69.926857],[22.673685,69.513268],[22.273705,69.48259],[22.525221,69.226738],[22.474253,69.110207],[21.99329,69.071091],[21.632259,69.27755],[21.267241,69.312019],[20.551207,69.058762],[20.311365,68.92868],[20.209249,68.663055],[19.951008,68.550568],[20.219816,68.48288],[19.927128,68.356903],[18.997116,68.51619],[18.126932,68.536102],[18.010155,68.611427],[17.291019,68.561279],[16.575487,68.544304],[16.614584,68.643753],[17.250521,68.756767],[17.622917,68.89167],[17.489584,68.979164],[18.085417,69.229164],[17.995312,69.301567],[18.352604,69.409897],[18.673437,69.322395],[18.933332,69.322914]]],[[[20.723438,70.231766],[20.745832,70.043747],[20.396355,70.058853],[20.408854,70.176567],[20.723438,70.231766]]],[[[19.635937,70.281769],[20.122396,70.098434],[19.766666,70.054169],[19.635937,70.281769]]]]},"properties":{"cartodb_id":17,"id_1":17,"id_0":169,"varname_1":"Troms fylke|Tromsø|Troms-Fylki","nl_name_1":null,"engtype_1":"County","type_1":"Fylke","name_1":"Troms","name_0":"Norway","iso":"NOR"}},
  {"type":"Feature","geometry":{"type":"Polygon","coordinates":[[[6.935278,58.057083],[6.624167,58.071804],[6.664722,58.239029],[6.396946,58.270416],[6.610364,58.373512],[6.625694,58.69545],[6.548313,58.82452],[6.603575,58.976826],[6.906821,59.11359],[6.932773,59.184834],[7.17198,59.167931],[7.110436,59.001789],[7.163638,58.838104],[7.571533,58.860481],[7.554216,58.689903],[7.723,58.464615],[8.19824,58.250393],[8.183057,58.141529],[8.039166,58.146805],[7.534723,57.97403],[7.4525,58.020695],[6.935278,58.057083]]]},"properties":{"cartodb_id":18,"id_1":18,"id_0":169,"varname_1":"Vest-Agder fylke|Lister og Mandal|Vestur-Agðir","nl_name_1":null,"engtype_1":"County","type_1":"Fylke","name_1":"Vest-Agder","name_0":"Norway","iso":"NOR"}},
  {"type":"Feature","geometry":{"type":"Polygon","coordinates":[[[10.451943,59.174583],[10.314167,59.071529],[9.962499,58.96014],[9.835583,59.038193],[9.879636,59.169075],[9.771088,59.41021],[10.04881,59.468193],[9.976753,59.648727],[10.314885,59.69236],[10.404022,59.633194],[10.404166,59.63269],[10.332501,59.473473],[10.530833,59.316807],[10.451943,59.174583]]]},"properties":{"cartodb_id":19,"id_1":19,"id_0":169,"varname_1":"Vestfold fylke|Jarlsberg og Larvik","nl_name_1":null,"engtype_1":"County","type_1":"Fylke","name_1":"Vestfold","name_0":"Norway","iso":"NOR"}}
]};

var view = [63.42  , 10.4];

// function getColor(d) {
//     return d > 16 ? '#800026' :
//            d > 13  ? '#BD0026' :
//            d > 10  ? '#E31A1C' :
//            d > 8  ? '#FC4E2A' :
//            d > 5   ? '#FD8D3C' :
//            d > 3   ? '#FEB24C' :
//            d > 0   ? '#FED976' :
//                       '#FFEDA0';
// }

var currentCounty = "";

function getColor(d) {
    colors = ['#5df42f','#fbff30','#f49b42','#c94600'];

        return d > 9 ? colors[3] :
            d > 5  ? colors[2] :
                d > 2  ? colors[1]:
                    colors[0];

}

function style(feature) {
    return {
        fillColor: '#c6dbef',
        weight: 2,
        opacity: 1,
        // color: '',
        fillOpacity: 0.7
    };
}

function highlightFeature(e) {
    var layer = e.target;
    info._div.innerHTML = '<h4>Click on a county!</h4>'

    layer.setStyle({
        weight: 5,
        dashArray: '',
        fillOpacity: 0.7
    });

    // if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
    //     layer.bringToFront();
    // }
}

function resetHighlight(e) {
    geojson.resetStyle(e.target);
}

function deleteLayers(e) {
    geojson.resetStyle(e.target);
}


function zoomToFeature(e) {
    mymap.fitBounds(e.target.getBounds());
    view = e.latlng;
    currentCounty = e.target.feature.properties.name_1;
}

function onEachFeature(feature, layer) {
   layer.bindPopup("<h2>" + feature.properties.name_1 + "</h2>"
                    + "</head><br><input type='button' value='Show me the icicle data' class='marker-delete-button'/>");
    layer.on({
        mouseover: highlightFeature,
        mouseout: resetHighlight,
        click: zoomToFeature
    });
    layer.on("popupopen", onPopupOpen);
}

geojson = L.geoJson(fylkesdata, {
    style: style,
    onEachFeature: onEachFeature
}).addTo(mymap);

function onPopupOpen() {
  var feature = this;
    $(".marker-delete-button:visible").click(function () {
      // mymap.setView(view, 11);
      // mymap.setView([63.42  , 10.4], 11);
      if (currentCounty == "Sør-Trøndelag") {
        mymap.setView([63.42  , 10.4], 14);
        geojson.clearLayers();
        $.ajax({
          type: 'POST',
          // dataType: 'json',
          contentType: 'application/json',
          url: '/map.html',
          data: JSON.stringify(        {
                      "type": "Feature",
                      "properties": {},
                      "geometry": {
                              "type": "Point",
                              "coordinates": [0,0],
                      }
                  }),
          success: function(d) {

              var legend = L.control({position: 'bottomright'});

              legend.onAdd = function (map) {

                  var div = L.DomUtil.create('div', 'info legend'),
                      grades = [1, 2, 5, 9, 10],
                      labels = ["Good conditions", "Some snow", "Much snow", "Don´t you even think about it!"];
                  // loop through our density intervals and generate a label with a colored square for each interval
                  for (var i = 0; i < grades.length - 1; i++) {
                      div.innerHTML +=
                          '<i style="background:' + getColor(grades[i] + 1) + '"></i> ' +
                          '' + (labels[i] + '<br>');
                  }

                  return div;
              };

              legend.addTo(mymap);

            // SHOULD RETURN A COLLECTION OF geoJSON
            console.log("SUCCESS");
            info._div.innerHTML = '<h4>Click on a road!</h4>' + '<br>if no road is visible, click on the map!<br>if a road is nearby of where you clicked, <br>the application will find it.'

            L.geoJSON(d, {
                style: myStyle,
                onEachFeature: onEachFeature
            }).addTo(mymap);
          },
          error: function() {
            alert('error when giving coordinates to backend');
          }
        });

      } else {
        alert("This county does not have any icicle-data!\nHint: Try Sør-Trøndelag");
      }
    });
  }

  var info = L.control();

  info.onAdd = function (map) {
      this._div = L.DomUtil.create('div', 'info'); // create a div with a class "info"
      this.update();
      return this._div;
  };

  // method that we will use to update the control based on feature properties passed
  info.update = function (props) {
      this._div.innerHTML = '<h4>Click on a county!</h4>'
  };

  info.addTo(mymap);
